ESTIMATION TASK ‚Äî VERSION CHANGELOG
====================================

v18-procedure-page-mapping-update
-----------------------
- Updated BLOCK_TO_PROCEDURE_PAGES: declaration_submit block now maps to
  ['application_review'] instead of ['declaration'], matching the procedure task's
  merged review + declaration page (procedure task v10)

v17-port-change
-----------------------
- Port changed from 3001 to 3002
- Updated PROCEDURE_STATS_URL to point to procedure task on port 3001
- Updated dashboard message and R/Python snippet URLs

v16-improved-error-rate-prompt
-----------------------
- Improved error rate estimation prompt with concrete examples:
  - Explains the context (reading official documents, transferring info)
  - Lists 5 specific example errors in a bulleted list:
    wrong DOB, wrong eligibility decision, missing required document,
    wrong fuel type/env class, expired proof of residence
  - Clearer distinction between quality errors and formatting issues

v15-delete-data-button
-----------------------
- Added POST /api/delete-all-data endpoint (requires export key)
- Dashboard: "Erase All Data" section with two-step confirmation:
  Step 1: Click "Delete all data" button
  Step 2: Type exactly "i want to delete the data" + click Confirm
- Deletes all .jsonl/.json files in data directory

v14-analysis-dashboard
-----------------------
- Replaced minimal dashboard with full 6-section analysis dashboard:
  Section 1 ‚Äî Data Quality: sessions, completion, dropout rate, condition balance, median task time
  Section 2 ‚Äî Ground Truth: auto-fetches actual procedure times from procedure task server
    (configurable via PROCEDURE_STATS_URL env var, defaults to localhost:3000)
    Shows actual mean total time, actual rejection rate, per-block actual times
  Section 3 ‚Äî Estimation Accuracy:
    - Overall estimates vs. actual (mean, median, bias)
    - Condition comparison: detailed vs. simple mean/SD with Cohen's d
    - Per-block accuracy table: mean estimate, actual, bias %, SD, N (detailed condition)
    - Error rate estimation: mean predicted rejection rate vs. actual, by condition
  Section 4 ‚Äî Confidence: mean confidence by condition, per-block confidence breakdown
  Section 5 ‚Äî Behavioral Engagement: phases explored, steps expanded, time on task by condition
  Section 6 ‚Äî Demographics: admin experience, vehicle permit experience, overall confidence breakdown
- New /api/stats endpoint with comprehensive JSON output for all 6 sections
- Dashboard is client-side rendered (fetches /api/stats via JS like the procedure task)
- Added helper functions: median(), mean(), stdDev(), cohenD()
- Ground truth mapping: estimation blocks ‚Üí procedure task page groups
  (e.g., entering_personal_details ‚Üí applicant_details page)
- R and Python import snippets with t-test and Mann-Whitney examples
- Effect size interpretation labels (negligible/small/medium/large)
- Bias color coding: positive bias (overestimate) in red, negative (underestimate) in green
- Condition balance indicator with ‚úì/‚ö† visual feedback

v13-pilot-feedback-page
------------------------
- Added dedicated feedback page between demographics and completion, matching the
  procedure task's pilot framing
- Page explains this is a pilot and invites participants to share anything that was
  unclear, confusing, or could be improved
- Demographics button changed from "Submit and finish" to "Continue"
- Feedback textarea field named pilot_feedback (appears as demo_pilot_feedback in CSV)
- Removed old inline feedback textarea from the demographics form

v12-quality-estimation-fixes
-----------------------------
- Reworded error rate question to focus on application quality / rejection-worthy errors
  (wrong personal details, wrong eligibility decision, incorrect vehicle info) rather than
  formatting mistakes. Now asks: "What percentage of submitted applications contained at
  least one error serious enough to cause the application to be rejected?"
- Changed detailed submit button from "Review estimates" to "Continue"
- Added error rate estimate (percentage + confidence) to the summary/review page
- Fixed console startup message: now says "block-randomized, balanced" instead of "50/50"
- Saved v11 snapshot to versions folder

v11-error-rate-estimation
-------------------------
- Added error rate estimation page: participants estimate what percentage of applicants
  made at least one error during the procedure (0‚Äì100%) with a 5-point confidence scale
- Placed on a separate page after time estimation for both conditions, before the next step
  (summary for detailed, demographics for simple) ‚Äî avoids anchoring between time and error estimates
- Flow: detailed ‚Üí time blocks ‚Üí error rate ‚Üí summary ‚Üí demographics ‚Üí complete
        simple ‚Üí overall time ‚Üí error rate ‚Üí demographics ‚Üí complete
- Error rate data (percentage + confidence) included in submission payload and CSV export
  (columns: error_rate_percentage, error_rate_confidence)

v10-block-randomization
-----------------------
- Replaced deterministic balanced assignment with CONSORT-compliant block randomization
- Permuted blocks of size 4 (2 detailed + 2 simple, shuffled randomly within each block)
- Guarantees perfect balance at every 4th participant while maintaining unpredictability
- Random tie-breaker when counts are equal (previously always defaulted to "detailed")
- Excludes researcher-forced conditions (?CONDITION=) from the balancing count
- Graceful fallback if server restarts mid-block: reverts to balanced coin-flip

v9-neutral-header-subaction-tips
--------------------------------
- Renamed page title and header from "Time Estimation Task" to "Administrative Procedure Study"
  to avoid priming participants about time estimation
- Removed condition label (Simple/Detailed) from the header ‚Äî participants no longer see
  which experimental condition they are in
- Changed header icon from stopwatch (‚è±) to clipboard (üìã) to avoid time-related priming
- Added explicit instructions on both estimation pages (detailed and simple) explaining that
  participants can click on steps to reveal hidden sub-actions, with definitions of what
  "steps" and "sub-actions" are. Displayed as a styled tip box below the process map intro.

v8-spacing-decision-fix
-----------------------
- Fixed excessive empty space in phase 2 and 4 bands: rewrote adjustLayoutForZoneMinHeights()
  to distribute extra space evenly among gaps between steps within a zone (boundary-based
  proportional shifting), instead of concentrating all extra height below the last step
- Reduced zone padding (PAD_SVG 30 ‚Üí 16) for tighter card-to-zone fit
- Decision diamond (step 2.3) now shows resolved outcome: green ‚úì with label
  "Participants selected: 'Yes ‚Äî eligible'" ‚Äî clarifies that the procedure shown applies
  to participants who were found eligible

v7-two-page-estimation
----------------------
- Split both conditions into a two-page flow: instructions page ‚Üí estimation page
- Page 1 (identical for both): consent ‚Üí intro with all context (about the experiment,
  how it worked, overview, your task) ‚Üí "Begin estimation" button
- Page 2 (condition-specific):
    Simple: full interactive SVG process map + contextual reminder + single overall estimate
    Detailed: side-by-side SVG map with zone brackets + 5 estimation cards (A‚ÄìE)
- Added contextual reminder at top of estimation page so participants don't need to
  navigate back to re-read instructions
- Rationale: equalizes experience structure across conditions, ensures participants read
  instructions before estimating, avoids visual overload on a single page

v6-inline-dynamic-spacing
-------------------------
- Moved estimation inline onto the intro page (single-page layout for both conditions)
- Added dynamic SVG zone spacing: adjustLayoutForZoneMinHeights() post-processes the SVG
  layout so zones expand when estimation cards are taller than their natural zone height
- Two-pass rendering: first render measures cards, re-renders with zoneMinHeights if needed
- Estimation cards no longer overlap with steps from other zones

v5-sidebyside-positioned-cards
------------------------------
- Full BPMN-style SVG process map with side-by-side estimation layout (detailed condition)
- Zone brackets with colored vertical bars + letter circle badges (A‚ÄìE) drawn on SVG
- Estimation cards absolutely positioned alongside their corresponding SVG zones
- Cards use SVG viewBox-to-pixel scale factor for precise vertical alignment
- Overlap prevention: cards shift downward if they would overlap the previous card
- Restored intro page for both conditions (was missing in earlier iteration)
- Fixed card sizing (too small in initial implementation)

v4-mini-svg-blocks
------------------
- Replaced text-based phase summaries with mini SVG process map blocks per estimation phase
- Each estimation block shows a compact visual of the steps it covers
- Steps are clickable to reveal hidden sub-actions inline

v3-likert-grouping-simple-inline
--------------------------------
- Switched confidence from dropdown to 5-point Likert scale with circular buttons
- Anchored scale: "Not at all confident" (1) to "Extremely confident" (5)
- Confidence made compulsory (validation blocks submission if missing)
- Grouped estimation blocks by phase with phase-colored headers
- Simple condition rendered inline (no separate page navigation)

v2-process-map-fixes
--------------------
- Fixed SVG process map rendering issues
- Corrected phase colors and step numbering
- Improved layout and spacing of process map elements
- Fixed interaction tracking for expanded steps

v1-redesign
-----------
- Initial design of the estimation task
- Two conditions: detailed (per-block estimation) and simple (overall estimate)
- Minutes + seconds dual input (no anchoring from suggested ranges)
- Interactive process map with expandable steps showing hidden sub-actions
- Server-side balanced randomization of conditions
- Prolific integration (PROLIFIC_PID, STUDY_ID, SESSION_ID)
- JSONL file-based data storage
- Consent ‚Üí Intro ‚Üí Estimation ‚Üí Demographics ‚Üí Completion flow
